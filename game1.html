<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Higher or Lower: Football Players</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            background-color: #f5f5f5;
        }
        .game-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .options-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .player-card {
            width: 45%;
            min-width: 250px;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        .player-card:hover {
            transform: scale(1.05);
            border-color: #4CAF50;
        }
        .player-card img {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 5px;
        }
        .player-name {
            font-weight: bold;
            margin: 10px 0;
            font-size: 18px;
        }
        .score-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            font-size: 18px;
        }
        .message {
            margin: 20px 0;
            font-size: 20px;
            min-height: 30px;
            color: #d32f2f;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 2px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .game-mode {
            margin: 20px 0;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Higher or Lower: Football Players</h1>
        
        <div id="setup-screen">
            <div class="game-mode">
                <h2>Choose Game Mode:</h2>
                <button id="appearances-btn">Higher Appearances</button>
                <button id="goals-btn">Higher Goals</button>
            </div>
        </div>
        
        <div id="game-screen" class="hidden">
            <div class="score-container">
                <div>Score: <span id="score">0</span></div>
                <div>High Score: <span id="high-score">0</span></div>
            </div>
            
            <div class="message" id="message"></div>
            
            <div class="options-container">
                <div class="player-card" id="player1" onclick="choosePlayer(1)">
                    <img id="img1" src="" alt="Player 1">
                    <div class="player-name" id="name1">Player 1</div>
                </div>
                
                <div class="player-card" id="player2" onclick="choosePlayer(2)">
                    <img id="img2" src="" alt="Player 2">
                    <div class="player-name" id="name2">Player 2</div>
                </div>
            </div>
            
            <button id="restart-btn" class="hidden">Play Again</button>
        </div>
    </div>

    <script>
        // Game variables
        let players = [];
        let currentPlayers = [];
        let score = 0;
        let highScore = 0;
        let gameMode = '';
        let gameOver = false;
        let maxPlayer = null;
        let bannedPlayer = null;

        // DOM elements
        const setupScreen = document.getElementById('setup-screen');
        const gameScreen = document.getElementById('game-screen');
        const scoreDisplay = document.getElementById('score');
        const highScoreDisplay = document.getElementById('high-score');
        const messageDisplay = document.getElementById('message');
        const restartBtn = document.getElementById('restart-btn');
        const appearancesBtn = document.getElementById('appearances-btn');
        const goalsBtn = document.getElementById('goals-btn');

        // Load player data from JSON
        async function loadPlayerData() {
            try {
                const response = await fetch('players.json');
                players = await response.json();
                
                // Find max values
                maxPlayer = {
                    appearances: Math.max(...players.map(p => p.appearances)),
                    goals: Math.max(...players.map(p => p.goals))
                };
            } catch (error) {
                console.error("Error loading player data:", error);
                messageDisplay.textContent = "Error loading player data. Please try again.";
            }
        }

        // Initialize the game
        async function initGame() {
            await loadPlayerData();
            
            // Load high score from localStorage
            highScore = localStorage.getItem('highScore') || 0;
            highScoreDisplay.textContent = highScore;
            
            // Set up event listeners
            appearancesBtn.addEventListener('click', () => startGame('appearances'));
            goalsBtn.addEventListener('click', () => startGame('goals'));
            restartBtn.addEventListener('click', resetGame);
        }

        // Start the game with selected mode
        function startGame(mode) {
            gameMode = mode;
            score = 0;
            gameOver = false;
            bannedPlayer = null;
            
            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            restartBtn.classList.add('hidden');
            
            scoreDisplay.textContent = score;
            messageDisplay.textContent = '';
            
            // Select two random players to start
            currentPlayers = getTwoRandomPlayers();
            displayPlayers();
        }

        // Get two random players (excluding banned player if exists)
        function getTwoRandomPlayers() {
            let availablePlayers = [...players];
            
            if (bannedPlayer) {
                availablePlayers = availablePlayers.filter(p => p.name !== bannedPlayer.name);
                bannedPlayer = null; // Only ban for one round
            }
            
            const shuffled = [...availablePlayers].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 2);
        }

        // Display the current players (shows only name and image)
        function displayPlayers() {
            const player1 = currentPlayers[0];
            const player2 = currentPlayers[1];
            
            document.getElementById('img1').src = player1.image;
            document.getElementById('name1').textContent = player1.name;
            
            document.getElementById('img2').src = player2.image;
            document.getElementById('name2').textContent = player2.name;
        }

        // Player makes a choice
        function choosePlayer(choice) {
            if (gameOver) return;
            
            const selectedPlayer = currentPlayers[choice - 1];
            const otherPlayer = currentPlayers[2 - choice];
            
            let selectedValue, otherValue;
            
            if (gameMode === 'appearances') {
                selectedValue = selectedPlayer.appearances;
                otherValue = otherPlayer.appearances;
            } else {
                selectedValue = selectedPlayer.goals;
                otherValue = otherPlayer.goals;
            }
            
            if (selectedValue >= otherValue) {
                // Correct choice
                score++;
                scoreDisplay.textContent = score;
                
                // Check if selected player has max value
                const maxValue = gameMode === 'appearances' ? maxPlayer.appearances : maxPlayer.goals;
                if (selectedValue === maxValue) {
                    // Ban this player for next round only
                    bannedPlayer = selectedPlayer;
                }
                
                // Keep the selected player and get a new random opponent
                const newOpponent = getNewOpponent(selectedPlayer);
                currentPlayers = [selectedPlayer, newOpponent];
                displayPlayers();
            } else {
                // Wrong choice - game over
                gameOver = true;
                messageDisplay.textContent = `Game Over! ${selectedPlayer.name} has fewer ${gameMode} than ${otherPlayer.name}.`;
                
                // Update high score if needed
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('highScore', highScore);
                    highScoreDisplay.textContent = highScore;
                }
                
                restartBtn.classList.remove('hidden');
            }
        }

        // Get a new opponent for the selected player
        function getNewOpponent(selectedPlayer) {
            let availablePlayers = players.filter(player => 
                player.name !== selectedPlayer.name && 
                (!bannedPlayer || player.name !== bannedPlayer.name)
            );
            
            // If no available players (unlikely with reasonable dataset), return a random one
            if (availablePlayers.length === 0) {
                availablePlayers = players.filter(player => player.name !== selectedPlayer.name);
            }
            
            const randomIndex = Math.floor(Math.random() * availablePlayers.length);
            return availablePlayers[randomIndex];
        }

        // Reset the game
        function resetGame() {
            setupScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
        }

        // Initialize the game when the page loads
        window.onload = initGame;
    </script>
</body>
</html>
